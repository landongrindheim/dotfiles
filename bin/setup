#!/bin/sh

# symlink all the things
sh ./install.sh

# set up homebrew
if [[ "$OSTYPE" == "darwin"* ]]; then
  if [ -n "$(command -v brew 2> /dev/null)" ]; then
    /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
  fi
  brew bundle
fi

if [ ! -d vim/autoload/plug.vim ];then
  curl -fLo ~/.vim/autoload/plug.vim --create-dirs https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim
fi

# open Vim, install plugins, then close Vim (exit Vim-Plug window, then Vim)
vim +PlugInstall +exit +exit


bashrc="$HOME/.bashrc"
source_script="[[ -s \"\$HOME/.bashrc\" ]] && source \"\$HOME/.bashrc\""

# add custom bash config to ~/.bash_profile
touch "$HOME/.bash_profile"
bash_profile="$HOME/.bash_profile"
if [ -f ${bashrc} ]; then
  # source ~/.bashrc.local in ~/.bash_profile if it isn't already
  grep -qF "${source_script}" ${bash_profile} || echo ${source_script} >> ${bash_profile}
fi

source ${bash_profile}
